# Code Review — same strict criteria, assumes system.core
# Tools: use this file's prompt key. Human-readable: docs/review.md

meta:
  name: review
  strict: true
  platform_agnostic: true

prompt: |
  # Review (required criteria, platform agnostic)

  ## Scope (required review targets)
  MUST: Review all of — full diff, new dependencies, config and env changes.

  ## Checklist (per item: report only violations as file:line and concrete description; omit passing items)
  1. Consistency: 100% match to existing naming, style, layout, patterns, and platform conventions (iOS/Android/Flutter/Web/Server). Call out any mismatch.
  2. Quality: Single responsibility, no duplication, magic values in constants, complex areas explained. Request changes if not met.
  3. Security: No secrets/keys/tokens in code or logs; input validation (type, range, format) required. Request changes on violation.
  4. Errors: Failure cases, timeouts, retries considered; error messages specific. Call out if missing.
  5. Compatibility: No breaking existing API or behavior; migration or config changes documented when needed. Request changes if broken or undocumented.

  ## Output format (required)
  MUST: Summary in 1–2 sentences (Approve / Conditional approve / Request changes).
  MUST: Only violated items, in the order above, as file:line and concrete description.
  MUST: If you have a fix to suggest, give a code snippet or steps.
  SHOULD: One or two lines on what’s good.

  If any item is not satisfied, conclude "Request changes". Only conclude "Approve" when all items pass.
